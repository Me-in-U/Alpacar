# 관리자 차량 등록 리다이렉트 건너뛰기 기능 테스트 가이드 (수정됨)

## 구현 내용
관리자 사용자(superuser)가 로그인할 때 차량이 등록되어 있지 않아도 차량 등록 페이지로 리다이렉트되지 않도록 수정했습니다.

## 문제점 및 해결
**발견된 문제**: 관리자 페이지(`/admin-*`)도 `requiresAuth: true` 메타를 가지고 있어서 차량 등록 체크 로직에 걸렸음
**해결 방법**: 관리자 페이지 경로를 먼저 체크하여 차량 등록 로직을 완전히 건너뛰도록 수정

## 변경된 파일
- `frontend/alpacar-vue/src/router/index.ts`

## 변경 내용
1. **useUserStore 임포트 추가**: 사용자 정보에 접근하기 위해 추가
2. **관리자 페이지 우선 체크**: `/admin`으로 시작하는 경로는 차량 등록 체크를 완전히 건너뜀
3. **이중 보안**: 관리자 페이지가 아닌 경우에도 `is_staff` 속성을 체크하여 관리자는 건너뜀

## 동작 방식
```javascript
// 1단계: 관리자 페이지인지 먼저 체크
if (to.path.startsWith("/admin")) {
    console.log("관리자 페이지 접근입니다. 차량 등록 체크를 건너뜁니다.");
    next();
} else {
    // 2단계: 일반 사용자 페이지에서도 관리자인지 체크
    const userStore = useUserStore();
    const isAdmin = userStore.me?.is_staff ?? false;
    
    if (isAdmin) {
        console.log("관리자 사용자입니다. 차량 등록 체크를 건너뜁니다.");
        next();
    } else {
        // 일반 사용자만 차량 등록 체크
        const hasVehicle = await hasVehicleRegistered();
        // ... 기존 로직
    }
}
```

## 테스트 방법

### 1. 관리자 계정 테스트
1. 관리자 계정(`is_staff: true`)으로 로그인
2. 차량을 등록하지 않은 상태에서 메인 페이지나 기타 인증 필요 페이지에 접근
3. **예상 결과**: 차량 등록 페이지(`/social-login-info`)로 리다이렉트되지 않고 요청한 페이지로 바로 접근 가능
4. **콘솔 로그**: "관리자 사용자입니다. 차량 등록 체크를 건너뜁니다." 메시지 확인

### 2. 일반 사용자 테스트
1. 일반 사용자 계정(`is_staff: false`)으로 로그인
2. 차량을 등록하지 않은 상태에서 메인 페이지나 기타 인증 필요 페이지에 접근
3. **예상 결과**: 기존과 동일하게 차량 등록 페이지(`/social-login-info`)로 리다이렉트
4. **콘솔 로그**: "차량 등록이 필요합니다. 차량 등록 페이지로 이동합니다." 메시지 확인

### 3. 관리자 페이지 접근 테스트
1. 관리자 계정으로 로그인
2. `/admin-main`, `/admin-parkinglogs` 등 관리자 페이지에 접근
3. **예상 결과**: 정상적으로 접근 가능 (기존 동작 유지)

## 주의사항
- 관리자 여부는 사용자 스토어의 `is_staff` 속성으로 판단합니다
- 이 속성은 백엔드에서 로그인 시 제공되는 사용자 정보에 포함되어야 합니다
- 관리자도 일반 사용자 기능(푸시 알림 등)을 사용할 수 있습니다

## 백엔드 요구사항
백엔드에서 사용자 정보 API(`/users/me/`)가 `is_staff` 필드를 포함해야 합니다:
```json
{
  "email": "admin@example.com",
  "name": "관리자",
  "nickname": "admin",
  "phone": "010-1234-5678",
  "push_on": true,
  "score": 100,
  "is_staff": true,  // 관리자 여부
  "vapid_public_key": "..."
}
```